import{L as h,s as c,B as m,m as y,_ as p,o as n,c as d,a,F as b,r as k,l,v as i,e as r,t as _,d as u}from"./index.js";const x={setup(){const e=h();e.getAllHistory();const{history:o}=c(e);return m({title:"History"}),{marked:y,events:o,historyStore:e}},computed:{sortedEvents(){return this.events.sort((e,o)=>("end_date"in e||(e.end_date={year:"",month:"",day:""}),"end_date"in o||(o.end_date={year:"",month:"",day:""}),Number(e.start_date.year)>Number(o.start_date.year)?-1:Number(e.start_date.year)<Number(o.start_date.year)?1:Number(e.start_date.month)>Number(o.start_date.month)?-1:Number(e.start_date.month)<Number(o.start_date.month)?1:Number(e.start_date.day)>Number(o.start_date.day)?-1:Number(e.start_date.day)<Number(o.start_date.day)?1:0))}},data(){return{monthIndex:["Neradan","Dorunor","Trimalan","Sylvanus","Gaiana","Alohiman","Coranus","Moltyr","Saris","Maridia","Tockra","Amatherin"]}},methods:{convertMonth(e){return this.monthIndex[e-1]},event(){return{text:{headline:"",text:""},start_date:{day:1,month:1,year:1846},end_date:{day:1,month:1,year:1846},expand:!0,edit:!0}},addEvent(){this.events.push(this.event())},save(e){e.edit=!1,e._id?this.historyStore.saveUpdate(e):this.historyStore.saveNew(e)},deleteEvent(e){window.confirm("Are you sure you want to delete this event? It cannot be recovered.")&&(e._id?this.historyStore.deleteHistory(e):this.events.splice(this.events.indexOf(e),1))}}},f={class:"col-sm-12"},V={class:"btn-group"},N={key:0},U={class:"row"},C={class:"col-12"},M=a("label",null,"Title",-1),S=["onUpdate:modelValue"],D={class:"col-6"},E=a("label",null,"Start Date",-1),$=["onUpdate:modelValue"],g=a("br",null,null,-1),w=["onUpdate:modelValue"],T=a("br",null,null,-1),H=["onUpdate:modelValue"],A={class:"col-6"},B=a("label",null,"End Date",-1),L=["onUpdate:modelValue"],I=a("br",null,null,-1),F=["onUpdate:modelValue"],Y=a("br",null,null,-1),v=["onUpdate:modelValue"],G={class:"row"},O={class:"col-12"},R=a("label",null,"Description",-1),j=["onUpdate:modelValue"],q={class:"btn-group"},z=["onClick"],J=["onClick"],K={key:1},P={class:"card-title"},Q={key:0},W={key:1},X={key:0},Z=["onClick"],tt=["onClick"],et={key:0},at={key:1},st=["innerHTML"];function ot(e,o,nt,dt,rt,lt){return n(),d("div",f,[a("div",V,[a("button",{class:"btn btn-primary",onClick:o[0]||(o[0]=t=>e.addEvent())},"+")]),(n(!0),d(b,null,k(e.sortedEvents,t=>(n(),d("div",{key:t.start_date.year+t.start_date.month+t.start_date.day+t.text.headline,class:"card"},[t.edit?(n(),d("div",N,[a("div",U,[a("div",C,[M,l(a("input",{type:"text",class:"charsheet-text","onUpdate:modelValue":s=>t.text.headline=s},null,8,S),[[i,t.text.headline]])]),a("div",D,[E,r(" Day: "),l(a("input",{type:"number",class:"charsheet-num","onUpdate:modelValue":s=>t.start_date.day=s},null,8,$),[[i,t.start_date.day]]),g,r(" Month: "),l(a("input",{type:"number",class:"charsheet-num","onUpdate:modelValue":s=>t.start_date.month=s},null,8,w),[[i,t.start_date.month]]),T,r(" Year: "),l(a("input",{type:"number",class:"charsheet-num","onUpdate:modelValue":s=>t.start_date.year=s},null,8,H),[[i,t.start_date.year]])]),a("div",A,[B,r(" Day: "),l(a("input",{type:"number",class:"charsheet-num","onUpdate:modelValue":s=>t.end_date.day=s},null,8,L),[[i,t.end_date.day]]),I,r(" Month: "),l(a("input",{type:"number",class:"charsheet-num","onUpdate:modelValue":s=>t.end_date.month=s},null,8,F),[[i,t.end_date.month]]),Y,r(" Year: "),l(a("input",{type:"number",class:"charsheet-num","onUpdate:modelValue":s=>t.end_date.year=s},null,8,v),[[i,t.end_date.year]])])]),a("div",G,[a("div",O,[R,l(a("textarea",{class:"charsheet-textarea","onUpdate:modelValue":s=>t.text.text=s},null,8,j),[[i,t.text.text]])])]),a("div",q,[a("button",{class:"btn btn-primary",onClick:s=>e.save(t)},"Save",8,z),a("button",{class:"btn btn-danger",onClick:s=>e.deleteEvent(t)},"Delete",8,J)])])):(n(),d("div",K,[a("h4",P,[t.start_date.month?(n(),d("span",Q,_(t.start_date.day)+" "+_(e.convertMonth(t.start_date.month))+",",1)):u("",!0),r(_(t.start_date.year)+" ",1),t.end_date.year?(n(),d("span",W,[r(" - "),t.end_date.month?(n(),d("span",X,_(t.end_date.day)+" "+_(e.convertMonth(t.end_date.month))+",",1)):u("",!0),r(" "+_(t.end_date.year),1)])):u("",!0),r(" "+_(t.text.headline)+" ",1),a("button",{class:"btn btn-warning",onClick:s=>t.edit=!0},"Edit",8,Z),a("button",{type:"button",class:"btn btn-primary",style:{float:"right"},onClick:s=>t.expand=!t.expand},[t.expand?(n(),d("span",et,"\u25B2")):u("",!0),t.expand?u("",!0):(n(),d("span",at,"\u25BC"))],8,tt)]),t.expand?(n(),d("div",{key:0,innerHTML:e.marked.parse(t.text.text)},null,8,st)):u("",!0)]))]))),128))])}const _t=p(x,[["render",ot]]);export{_t as default};
