import{h,_ as c}from"./index.js";import{h as m,u as y,m as p,o as n,c as d,f as e,F as b,l as x,p as l,v as i,k as r,t as _,g as u}from"./vendor.js";var f={setup(){const s=h();s.getAllHistory();const{history:o}=m(s);return y({title:"History"}),{marked:p,events:o,historyStore:s}},computed:{sortedEvents(){return this.events.sort((s,o)=>s.edit?-1:o.edit?1:("end_date"in s||(s.end_date={year:"",month:"",day:""}),"end_date"in o||(o.end_date={year:"",month:"",day:""}),Number(s.start_date.year)>Number(o.start_date.year)?-1:Number(s.start_date.year)<Number(o.start_date.year)?1:Number(s.start_date.month)>Number(o.start_date.month)?-1:Number(s.start_date.month)<Number(o.start_date.month)?1:Number(s.start_date.day)>Number(o.start_date.day)?-1:Number(s.start_date.day)<Number(o.start_date.day)?1:0))}},data(){return{monthIndex:["Neradan","Dorunor","Trimalan","Sylvanus","Gaiana","Alohiman","Coranus","Moltyr","Saris","Maridia","Tockra","Amatherin"]}},methods:{convertMonth(s){return this.monthIndex[s-1]},event(){return{text:{headline:"",text:""},start_date:{day:1,month:1,year:1846},end_date:{day:1,month:1,year:1846},expand:!0,edit:!0}},addEvent(){this.events.push(this.event())},save(s){s.edit=!1,s._id?this.historyStore.saveUpdate(s):this.historyStore.saveNew(s)},deleteEvent(s){window.confirm("Are you sure you want to delete this event? It cannot be recovered.")&&(s._id?this.historyStore.deleteHistory(s):this.events.splice(this.events.indexOf(s),1))}}};const k={class:"col-sm-12"},V={class:"btn-group"},N={key:0},U={class:"row"},C={class:"col-12"},M=e("label",null,"Title",-1),w=["onUpdate:modelValue"],S={class:"col-6"},g=e("label",null,"Start Date",-1),D=e("br",null,null,-1),E=["onUpdate:modelValue"],$=e("br",null,null,-1),T=["onUpdate:modelValue"],v=e("br",null,null,-1),H=["onUpdate:modelValue"],A={class:"col-6"},B=e("label",null,"End Date",-1),I=e("br",null,null,-1),L=["onUpdate:modelValue"],F=e("br",null,null,-1),Y=["onUpdate:modelValue"],G=e("br",null,null,-1),O=["onUpdate:modelValue"],R={class:"row"},j={class:"col-12"},q=e("label",null,"Description",-1),z=["onUpdate:modelValue"],J={class:"btn-group"},K=["onClick"],P=["onClick"],Q={key:1},W={class:"card-title"},X={key:0},Z={key:1},tt={key:0},et={class:"smalltext"},st=["onClick"],at=["onClick"],ot={key:0},nt={key:1},dt=["innerHTML"];function rt(s,o,lt,it,_t,ut){return n(),d("div",k,[e("div",V,[e("button",{class:"btn btn-primary",onClick:o[0]||(o[0]=t=>s.addEvent())},"+")]),(n(!0),d(b,null,x(s.sortedEvents,t=>(n(),d("div",{key:t._id,class:"card"},[t.edit?(n(),d("div",N,[e("div",U,[e("div",C,[M,l(e("input",{type:"text",class:"charsheet-text","onUpdate:modelValue":a=>t.text.headline=a},null,8,w),[[i,t.text.headline]])]),e("div",S,[g,D,r(" Month: "),l(e("input",{type:"number",class:"charsheet-num","onUpdate:modelValue":a=>t.start_date.month=a},null,8,E),[[i,t.start_date.month]]),$,r(" Day: "),l(e("input",{type:"number",class:"charsheet-num","onUpdate:modelValue":a=>t.start_date.day=a},null,8,T),[[i,t.start_date.day]]),v,r(" Year: "),l(e("input",{type:"number",class:"charsheet-num","onUpdate:modelValue":a=>t.start_date.year=a,style:{"max-width":"75px"}},null,8,H),[[i,t.start_date.year]])]),e("div",A,[B,I,r(" Month: "),l(e("input",{type:"number",class:"charsheet-num","onUpdate:modelValue":a=>t.end_date.month=a},null,8,L),[[i,t.end_date.month]]),F,r(" Day: "),l(e("input",{type:"number",class:"charsheet-num","onUpdate:modelValue":a=>t.end_date.day=a},null,8,Y),[[i,t.end_date.day]]),G,r(" Year: "),l(e("input",{type:"number",class:"charsheet-num","onUpdate:modelValue":a=>t.end_date.year=a,style:{"max-width":"75px"}},null,8,O),[[i,t.end_date.year]])])]),e("div",R,[e("div",j,[q,l(e("textarea",{class:"charsheet-textarea","onUpdate:modelValue":a=>t.text.text=a},null,8,z),[[i,t.text.text]])])]),e("div",J,[e("button",{class:"btn btn-primary",onClick:a=>s.save(t)},"Save",8,K),e("button",{class:"btn btn-danger",onClick:a=>s.deleteEvent(t)},"Delete",8,P)])])):(n(),d("div",Q,[e("h4",W,[r(_(t.start_date.year)+" ",1),t.start_date.month?(n(),d("span",X,_(s.convertMonth(t.start_date.month))+" "+_(t.start_date.day),1)):u("",!0),t.end_date.year?(n(),d("span",Z,[r(" - "+_(t.end_date.year)+" ",1),t.end_date.month?(n(),d("span",tt,_(s.convertMonth(t.end_date.month))+" "+_(t.end_date.day),1)):u("",!0)])):u("",!0),r(": "),e("span",et,_(t.text.headline),1),e("button",{class:"btn btn-warning",onClick:a=>t.edit=!0},"Edit",8,st),e("button",{type:"button",class:"btn btn-primary",style:{float:"right"},onClick:a=>t.expand=!t.expand},[t.expand?(n(),d("span",ot,"\u25B2")):u("",!0),t.expand?u("",!0):(n(),d("span",nt,"\u25BC"))],8,at)]),t.expand?(n(),d("div",{key:0,innerHTML:s.marked.parse(t.text.text)},null,8,dt)):u("",!0)]))]))),128))])}var mt=c(f,[["render",rt]]);export{mt as default};
